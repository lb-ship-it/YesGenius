<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <title>YES Genius</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;800&display=swap" rel="stylesheet">
    <style>
        :root { 
            --primary: #009432; 
            --primary-grad: linear-gradient(135deg, #009432 0%, #006266 100%); 
            --accent: #6c5ce7; 
            --bg: #f4f7f6; 
            --card-bg: #ffffff; 
            --text: #2d3436; 
            --text-light: #636e72; 
            --border: #dfe6e9; 
            --radius: 16px; 
            --gold: #f1c40f; /* Zlat√° pro Premium */
        }
        [data-theme="dark"] { 
            --bg: #121212; --card-bg: #1e1e1e; --text: #e0e0e0; --text-light: #a0a0a0; --border: #333333; 
        }
        
        body { font-family: 'Poppins', sans-serif; background: var(--bg); color: var(--text); display: flex; flex-direction: column; align-items: center; min-height: 100vh; margin: 0; padding: 20px; transition: background 0.3s; box-sizing: border-box; }
        
        .header-bar { width: 100%; max-width: 650px; display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; gap: 10px; }
        
        .theme-toggle { background: none; border: none; font-size: 1.5rem; cursor: pointer; padding: 5px; transition: 0.2s; }
        
        .lang-select { padding: 10px; border-radius: 12px; border: 1px solid var(--border); background: var(--card-bg); color: var(--text); font-family: inherit; font-size: 0.9rem; cursor: pointer; flex-grow: 1; max-width: 180px; }

        /* NOV√â: Premium tlaƒç√≠tko */
        .premium-btn {
            background: linear-gradient(135deg, #f1c40f 0%, #f39c12 100%);
            color: #fff; border: none; padding: 10px 15px; border-radius: 12px;
            font-weight: 700; cursor: pointer; display: flex; align-items: center; gap: 5px;
            box-shadow: 0 4px 10px rgba(241, 196, 15, 0.3); transition: 0.2s; font-size: 0.9rem;
            white-space: nowrap;
        }
        .premium-btn:hover { transform: scale(1.05); box-shadow: 0 6px 15px rgba(241, 196, 15, 0.5); }

        .main-card { background: var(--card-bg); padding: 2.5rem; padding-top: 1rem; border-radius: 24px; box-shadow: 0 15px 40px rgba(0,0,0,0.1); width: 100%; max-width: 650px; border-top: 6px solid var(--primary); transition: transform 0.3s; }
        .logo-container { text-align: center; margin-bottom: 10px; }
        .logo-img { max-width: 110px; height: auto; display: block; margin: 0 auto; filter: drop-shadow(0 4px 6px rgba(0,0,0,0.1)); }
        
        label { font-weight: 600; font-size: 0.8rem; color: var(--text-light); margin-bottom: 6px; display: block; margin-top: 15px; text-transform: uppercase; letter-spacing: 0.5px; }
        input, select { width: 100%; padding: 14px; border-radius: var(--radius); border: 2px solid var(--border); font-size: 1rem; background: var(--card-bg); color: var(--text); transition: 0.2s; box-sizing: border-box; font-family: inherit; }
        input:focus, select:focus { border-color: var(--accent); outline: none; }

        .row { display: flex; gap: 15px; }
        .col { flex: 1; }

        button#genBtn { width: 100%; padding: 18px; margin-top: 30px; background: var(--primary-grad); color: white; border: none; border-radius: var(--radius); font-weight: 800; font-size: 1.1rem; cursor: pointer; transition: all 0.2s; box-shadow: 0 10px 20px rgba(0, 148, 50, 0.2); }
        button#genBtn:hover { transform: translateY(-2px); box-shadow: 0 15px 30px rgba(0, 148, 50, 0.3); }
        button:disabled { opacity: 0.7; cursor: wait; }

        .result-area { margin-top: 30px; display: flex; flex-direction: column; gap: 15px; }
        .variant { background: var(--card-bg); padding: 20px; border-radius: var(--radius); border: 1px solid var(--border); border-left: 5px solid var(--accent); animation: slideUp 0.4s ease-out forwards; }
        .variant-text { font-size: 1.05rem; line-height: 1.6; margin-bottom: 15px; white-space: pre-wrap; }
        .actions { display: flex; justify-content: flex-end; gap: 10px; border-top: 1px solid var(--border); padding-top: 10px; }
        .action-btn { background: transparent; border: 1px solid var(--border); padding: 6px 14px; border-radius: 8px; cursor: pointer; font-size: 0.85rem; font-weight: 600; color: var(--text-light); transition: 0.2s; display: flex; align-items: center; gap: 6px; }

        @keyframes slideUp { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .footer { text-align: center; margin-top: 40px; margin-bottom: 20px; color: var(--text-light); font-size: 0.75rem; max-width: 500px; line-height: 1.6; opacity: 0.8; }
        .secure-icon { color: var(--primary); font-size: 1.2rem; vertical-align: middle; margin-right: 5px; }
        @media (max-width: 500px) { .row { flex-direction: column; gap: 0; } }
    </style>
</head>
<body>

    <div class="header-bar">
        <select id="jazyk" class="lang-select" onchange="changeLanguage()"></select>
        <button class="premium-btn" onclick="buyPremium()" id="payBtn">üëë Premium</button>
        <button class="theme-toggle" onclick="toggleTheme()" id="themeBtn">üåô</button>
    </div>

    <div class="main-card">
        <div class="logo-container">
            <img src="yg app.png" alt="YES Genius" class="logo-img" onerror="this.style.display='none'; this.nextElementSibling.style.display='block'">
            <h1 style="display:none; color:var(--primary);">YES Genius</h1>
        </div>
        
        <div class="row">
            <div class="col">
                <label id="lbl_format">Typ zpr√°vy</label>
                <select id="format"><option value="sms">SMS / Chat</option><option value="email">E-mail</option></select>
            </div>
            <div class="col">
                <label id="lbl_style">Styl</label>
                <select id="styl"></select>
            </div>
        </div>

        <label id="lbl_who">Komu</label>
        <input list="who_list" id="adresat" onchange="updateReasons()" placeholder="...">
        <datalist id="who_list"></datalist>

        <label id="lbl_reason">D≈Øvod</label>
        <input list="reason_list" id="kategorie" placeholder="...">
        <datalist id="reason_list"></datalist>

        <button id="genBtn" onclick="generovat()">‚ú® Generovat varianty</button>

        <div id="result-area" class="result-area"></div>
    </div>

    <div class="footer">
        <div><span class="secure-icon">üîí</span> <strong>No Data Collection</strong></div>
        <span id="privacy_text">This application does not collect, store, or share any personal data.</span>
    </div>

    <script>
        const LANGUAGES = [
            { code: "cs", name: "üá®üáø ƒåe≈°tina" }, { code: "en_us", name: "üá∫üá∏ English (US)" }, { code: "uk", name: "üá∫üá¶ –£–∫—Ä–∞—ó–Ω—Å—å–∫–∞" },
            { code: "de", name: "üá©üá™ Deutsch" }, { code: "sk", name: "üá∏üá∞ Slovenƒçina" }, { code: "pl", name: "üáµüá± Polski" },
            { code: "ru", name: "üá∑üá∫ –†—É—Å—Å–∫–∏–π" }, { code: "fr", name: "üá´üá∑ Fran√ßais" }, { code: "es", name: "üá™üá∏ Espa√±ol" },
            { code: "it", name: "üáÆüáπ Italiano" }, { code: "pt", name: "üáµüáπ Portugu√™s" }, { code: "zh", name: "üá®üá≥ ‰∏≠Êñá (Chinese)" },
            { code: "ja", name: "üáØüáµ Êó•Êú¨Ë™û (Japanese)" }, { code: "ko", name: "üá∞üá∑ ÌïúÍµ≠Ïñ¥ (Korean)" }, { code: "vi", name: "üáªüá≥ Ti·∫øng Vi·ªát" },
            { code: "tr", name: "üáπüá∑ T√ºrk√ße" }, { code: "ar", name: "üá∏üá¶ ÿßŸÑÿπÿ±ÿ®Ÿäÿ© (Arabic)" }, { code: "hi", name: "üáÆüá≥ ‡§π‡§ø‡§®‡•ç‡§¶‡•Ä (Hindi)" },
            { code: "th", name: "üáπüá≠ ‡πÑ‡∏ó‡∏¢ (Thai)" }, { code: "id", name: "üáÆüá© Indonesia" }, { code: "bn", name: "üáßüá© ‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ (Bengali)" },
            { code: "fil", name: "üáµüá≠ Filipino" }, { code: "fa", name: "üáÆüá∑ ŸÅÿßÿ±ÿ≥€å (Persian)" }
        ];

        const BASE_STYLES = ["Professional", "Funny", "Dramatic", "Brief", "Polite"];
        const BASE_REC = ["Boss", "Wife", "Husband", "Girlfriend", "Boyfriend", "Parents", "Teacher", "Friend"];
        const BASE_RES = ["Overslept", "Sick", "Traffic", "Family emergency", "Migraine", "Pipe burst", "Doctor", "Working from home"];

        // P≈ôid√°n p≈ôeklad pro "Premium" a "Lifetime"
        const UI_TEXTS = {
            cs: { 
                l: ["Typ zpr√°vy", "Styl", "Komu", "D≈Øvod"], b: "‚ú® Generovat", p: ["Vyber...", "Vyber..."], priv: "Aplikace nesb√≠r√° ≈æ√°dn√° osobn√≠ data.", 
                prem: "üëë Premium", styles: ["Profesion√°ln√≠", "Vtipn√Ω", "Dramatick√Ω", "Struƒçn√Ω", "Uctiv√Ω"],
                rec: ["≈†√©f", "Man≈æelka", "Man≈æel", "P≈ô√≠telkynƒõ", "P≈ô√≠tel", "Rodiƒçe", "Uƒçitel", "Kamar√°d"],
                res: ["Zaspal jsem", "Nen√≠ mi dob≈ôe", "Z√°cpa", "Rodinn√© d≈Øvody", "Migr√©na", "Praskl√© potrub√≠", "Doktor", "Pr√°ce z domova"]
            },
            uk: { 
                l: ["–¢–∏–ø –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è", "–°—Ç–∏–ª—å", "–ö–æ–º—É", "–ü—Ä–∏—á–∏–Ω–∞"], b: "‚ú® –ó–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏", p: ["–û–±–µ—Ä—ñ—Ç—å...", "–û–±–µ—Ä—ñ—Ç—å..."], priv: "–î–æ–¥–∞—Ç–æ–∫ –Ω–µ –∑–±–∏—Ä–∞—î –¥–∞–Ω–∏—Ö.", 
                prem: "üëë –ü—Ä–µ–º—ñ—É–º", styles: ["–ü—Ä–æ—Ñ–µ—Å—ñ–π–Ω–∏–π", "–°–º—ñ—à–Ω–∏–π", "–î—Ä–∞–º–∞—Ç–∏—á–Ω–∏–π", "–ö–æ—Ä–æ—Ç–∫–∏–π", "–í–≤—ñ—á–ª–∏–≤–∏–π"],
                rec: ["–®–µ—Ñ", "–î—Ä—É–∂–∏–Ω–∞", "–ß–æ–ª–æ–≤—ñ–∫", "–î—ñ–≤—á–∏–Ω–∞", "–•–ª–æ–ø–µ—Ü—å", "–ë–∞—Ç—å–∫–∏", "–í—á–∏—Ç–µ–ª—å", "–î—Ä—É–≥"],
                res: ["–ü—Ä–æ—Å–ø–∞–≤", "–ó–∞—Ö–≤–æ—Ä—ñ–≤", "–ó–∞—Ç–æ—Ä–∏", "–°—ñ–º–µ–π–Ω—ñ –æ–±—Å—Ç–∞–≤–∏–Ω–∏", "–ú—ñ–≥—Ä–µ–Ω—å", "–¢—Ä—É–±–∞", "–õ—ñ–∫–∞—Ä", "–ó –¥–æ–º—É"]
            },
            sk: {
                l: ["Typ spr√°vy", "≈†t√Ωl", "Komu", "D√¥vod"], b: "‚ú® Generova≈•", p: ["Vyber...", "Vyber..."], priv: "Aplik√°cia nezbiera d√°ta.", prem: "üëë Premium",
                styles: ["Profesion√°lny", "Vtipn√Ω", "Dramatick√Ω", "Struƒçn√Ω", "√öctiv√Ω"], rec: ["≈†√©f", "Man≈æelka", "Man≈æel", "Priateƒæka", "Priateƒæ", "Rodiƒçia", "Uƒçiteƒæ", "Kamar√°t"], res: ["Zaspal som", "Choroba", "Z√°pcha", "Rodina", "Migr√©na", "Potrubie", "Lek√°r", "Home office"]
            },
            en_us: { 
                l: ["Message Type", "Style", "To Whom", "Reason"], b: "‚ú® Generate", p: ["Select...", "Select..."], priv: "App collects no personal data.", prem: "üëë Premium",
                styles: BASE_STYLES, rec: BASE_REC, res: BASE_RES
            }
        };

        function init() {
            const langSelect = document.getElementById('jazyk');
            LANGUAGES.forEach(lang => {
                const opt = document.createElement('option'); opt.value = lang.code; opt.innerText = lang.name; langSelect.appendChild(opt);
            });
            changeLanguage(); 
            
            // Kontrola po n√°vratu z platby
            const urlParams = new URLSearchParams(window.location.search);
            if (urlParams.get('status') === 'success') {
                alert("üéâ Dƒõkujeme za zakoupen√≠ Lifetime licence!");
            }
        }

        function changeLanguage() {
            const langCode = document.getElementById('jazyk').value;
            const t = UI_TEXTS[langCode] || UI_TEXTS['en_us']; 

            document.getElementById('lbl_format').innerText = t.l[0];
            document.getElementById('lbl_style').innerText = t.l[1];
            document.getElementById('lbl_who').innerText = t.l[2];
            document.getElementById('lbl_reason').innerText = t.l[3];
            document.getElementById('genBtn').innerText = t.b;
            document.getElementById('payBtn').innerText = t.prem || "üëë Premium";
            document.getElementById('privacy_text').innerText = t.priv;
            
            const ph = Array.isArray(t.p) ? t.p : [t.p, t.p];
            document.getElementById('adresat').placeholder = ph[0];
            document.getElementById('kategorie').placeholder = ph[1];

            fillSelect('styl', t.styles);
            fillSelect('who_list', t.rec || BASE_REC);
            
            document.getElementById('adresat').value = ""; document.getElementById('kategorie').value = "";
            fillSelect('reason_list', t.res || BASE_RES);

            if (['ar', 'fa', 'he'].includes(langCode)) { document.body.dir = 'rtl'; } else { document.body.dir = 'ltr'; }
        }

        function fillSelect(id, items) {
            const el = document.getElementById(id); el.innerHTML = "";
            items.forEach(i => { const opt = document.createElement('option'); opt.value = i; opt.innerText = i; el.appendChild(opt); });
        }

        function updateReasons() {
            const langCode = document.getElementById('jazyk').value;
            const t = UI_TEXTS[langCode] || UI_TEXTS['en_us'];
            const inputVal = document.getElementById('adresat').value.toLowerCase();
            let reasons = t.res || BASE_RES;

            // Zjednodu≈°en√° logika pro CZ (lze roz≈°√≠≈ôit)
            if (langCode === 'cs') {
                if (inputVal.includes('man≈æel') || inputVal.includes('≈æena')) reasons = ["Zdr≈æel jsem se", "Kvƒõtin√°≈ôstv√≠ zav≈ôen√©", "Pomoc kamar√°dovi", "Z√°cpa", "Vybit√Ω mobil", "Bolest hlavy", "Zapomnƒõl jsem", "P≈ôekvapen√≠"];
                else if (inputVal.includes('≈°√©f')) reasons = ["Zaspal jsem", "Nemoc", "Z√°cpa", "D√≠tƒõ nemocn√©", "Migr√©na", "Auto", "L√©ka≈ô", "Home office"];
            }
            fillSelect('reason_list', reasons);
        }

        async function generovat() {
            const btn = document.getElementById('genBtn');
            const area = document.getElementById('result-area');
            const langSelect = document.getElementById('jazyk');
            
            if(!document.getElementById('adresat').value || !document.getElementById('kategorie').value) {
                area.innerHTML = `<div class=\"variant\" style=\"border-left-color:#ff7675; color:#d63031\">‚ö†Ô∏è ${langSelect.value === 'cs' ? 'Vypl≈à pros√≠m √∫daje.' : 'Please fill in details.'}</div>`;
                return;
            }

            btn.disabled = true; btn.innerText = "‚è≥ ..."; area.innerHTML = "";

            try {
                const res = await fetch('/generovat', {
                    method: 'POST', headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        jazyk: langSelect.options[langSelect.selectedIndex].text,
                        format: document.getElementById('format').value,
                        adresat: document.getElementById('adresat').value,
                        kategorie: document.getElementById('kategorie').value,
                        styl: document.getElementById('styl').value
                    })
                });
                const data = await res.json();
                if (data.error) throw new Error(data.error);

                data.variants.forEach((text, i) => {
                    const div = document.createElement('div'); div.className = 'variant'; div.style.animationDelay = (i * 0.1) + 's';
                    let shareBtn = navigator.share ? `<button class=\"action-btn\" onclick=\"shareText('${text.replace(/'/g, "\\'")}')\">üì§</button>` : '';
                    div.innerHTML = `<div class=\"variant-text\">${text}</div><div class=\"actions\">${shareBtn}<button class=\"action-btn\" onclick=\"copyText(this, '${text.replace(/'/g, "\\'")}')\">üìã</button></div>`;
                    area.appendChild(div);
                });
            } catch (e) { area.innerHTML = `<div class=\"variant\" style=\"color:red\">Error: ${e.message}</div>`; } 
            finally { btn.disabled = false; btn.innerText = (UI_TEXTS[langSelect.value] || UI_TEXTS['en_us']).b; }
        }

        async function buyPremium() {
            const btn = document.getElementById('payBtn');
            const originalText = btn.innerText;
            btn.innerText = "‚è≥...";
            try {
                // Vol√°n√≠ na backend pro vytvo≈ôen√≠ platby
                const res = await fetch('/platba', { method: 'POST' });
                const data = await res.json();
                if (data.error) alert("Chyba: " + data.error);
                else if (data.url) window.location.href = data.url; // P≈ôesmƒõrov√°n√≠ na Stripe
            } catch (e) { alert("Chyba: " + e.message); }
            finally { btn.innerText = originalText; }
        }

        function copyText(btn, text) { navigator.clipboard.writeText(text).then(() => { btn.innerText = "‚úÖ"; setTimeout(() => { btn.innerText = "üìã"; }, 2000); }); }
        async function shareText(text) { try { await navigator.share({ title: 'YES Genius', text: text }); } catch(e){} }
        function toggleTheme() {
            const b = document.body; const btn = document.getElementById('themeBtn');
            if (b.getAttribute('data-theme') === 'dark') { b.removeAttribute('data-theme'); btn.innerText = "üåô"; } 
            else { b.setAttribute('data-theme', 'dark'); btn.innerText = "‚òÄÔ∏è"; }
        }

        init();
    </script>
</body>
</html>
