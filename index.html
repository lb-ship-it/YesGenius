<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YES Genius | Professional Excuse Generator</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #8b5cf6; /* Fialov√° z loga */
            --accent: #10b981;  /* Zelen√° z loga */
            --glass: rgba(255, 255, 255, 0.7);
            --glass-border: rgba(255, 255, 255, 0.5);
            --text: #1f2937;
            --bg-gradient: linear-gradient(135deg, #a78bfa 0%, #34d399 100%);
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --glass: rgba(17, 24, 39, 0.7);
                --glass-border: rgba(255, 255, 255, 0.1);
                --text: #f3f4f6;
                --bg-gradient: linear-gradient(135deg, #4c1d95 0%, #065f46 100%);
            }
        }

        * { box-sizing: border-box; transition: all 0.3s ease; }
        
        body {
            font-family: 'Outfit', sans-serif;
            background: var(--bg-gradient);
            background-attachment: fixed; /* Parallax efekt */
            margin: 0;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 1rem;
            color: var(--text);
        }

        .glass-panel {
            background: var(--glass);
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            border: 1px solid var(--glass-border);
            border-radius: 24px;
            padding: 2.5rem;
            width: 100%;
            max-width: 550px;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
            display: flex;
            flex-direction: column;
            gap: 1.2rem;
        }

        /* LOGO */
        .logo-container { text-align: center; margin-bottom: 0.5rem; }
        .logo { 
            max-width: 140px; 
            filter: drop-shadow(0 4px 6px rgba(0,0,0,0.1)); 
            cursor: pointer;
        }
        .logo:hover { transform: scale(1.05); }

        h1, h2 { text-align: center; margin: 0; }
        .subtitle { 
            text-align: center; 
            opacity: 0.8; 
            font-size: 0.9rem; 
            margin-bottom: 1rem; 
        }

        /* INPUTY A SELECTY */
        label { font-weight: 500; font-size: 0.85rem; margin-left: 0.5rem; opacity: 0.9; }
        
        select, input, textarea {
            width: 100%;
            padding: 1rem;
            border-radius: 12px;
            border: 1px solid var(--glass-border);
            background: rgba(255, 255, 255, 0.3);
            font-size: 1rem;
            color: inherit;
            outline: none;
        }
        
        @media (prefers-color-scheme: dark) {
             select, input, textarea { background: rgba(0, 0, 0, 0.3); }
        }

        select:focus, input:focus {
            background: rgba(255, 255, 255, 0.5);
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.2);
        }

        /* TLAƒå√çTKA */
        .btn-main {
            background: linear-gradient(90deg, var(--primary), #7c3aed);
            color: white;
            font-weight: 700;
            border: none;
            padding: 1.2rem;
            border-radius: 12px;
            cursor: pointer;
            font-size: 1.1rem;
            box-shadow: 0 10px 15px -3px rgba(124, 58, 237, 0.3);
            margin-top: 1rem;
        }

        .btn-main:hover { transform: translateY(-2px); box-shadow: 0 20px 25px -5px rgba(124, 58, 237, 0.4); }
        .btn-main:active { transform: scale(0.98); }

        .btn-vip {
            background: linear-gradient(90deg, var(--accent), #059669);
            color: white;
            font-weight: 700;
            border: none;
            padding: 1rem;
            border-radius: 12px;
            cursor: pointer;
            font-size: 1rem;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 0.5rem;
            box-shadow: 0 4px 6px rgba(16, 185, 129, 0.2);
        }
        
        .btn-vip:hover { filter: brightness(1.1); }

        /* V√ùSLEDKY */
        #vysledek {
            margin-top: 1.5rem;
            display: none;
        }
        .result-card {
            background: rgba(255, 255, 255, 0.4);
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 0.5rem;
            border-left: 4px solid var(--primary);
            font-size: 0.95rem;
            line-height: 1.5;
        }
        @media (prefers-color-scheme: dark) {
            .result-card { background: rgba(0, 0, 0, 0.3); }
        }

        /* LOADING ANIMACE */
        .loader {
            border: 3px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top: 3px solid white;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
            display: none;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

    </style>
</head>
<body>

<div class="glass-panel">
    <div class="logo-container">
        <img src="logo.png" alt="YES Genius Logo" class="logo" onclick="location.reload()">
    </div>
    
    <p class="subtitle" id="txt-subtitle">Profesion√°ln√≠ gener√°tor omluv s umƒõlou inteligenc√≠.</p>

    <div>
        <label for="language-select">üåç Language / Jazyk</label>
        <select id="language-select" onchange="changeLanguage()">
            </select>
    </div>

    <div>
        <label id="lbl-recipient" for="recipient">üë§ Komu se omlouv√°te?</label>
        <select id="recipient" onchange="updateSuggestions()">
            <option value="boss">≈†√©f / Nad≈ô√≠zen√Ω</option>
            <option value="partner">Partner / Partnerka</option>
            <option value="teacher">Uƒçitel / Profesor</option>
            <option value="client">Klient / Z√°kazn√≠k</option>
            <option value="friend">Kamar√°d / Zn√°m√Ω</option>
            <option value="parents">Rodiƒçe / Rodina</option>
        </select>
    </div>

    <div>
        <label id="lbl-reason" for="reason">ü§î D≈Øvod (nebo si vymyslete vlastn√≠)</label>
        <input list="reasons-list" id="reason" placeholder="Nap≈ô. zaspal jsem...">
        <datalist id="reasons-list">
            </datalist>
    </div>

    <div>
        <label id="lbl-style" for="style">üé≠ Styl omluvy</label>
        <select id="style">
            <option value="professional">Profesion√°ln√≠ & Form√°ln√≠</option>
            <option value="regretful">Up≈ô√≠mn√° & Kaj√≠cn√°</option>
            <option value="creative">Kreativn√≠ & Vtipn√°</option>
            <option value="brief">Struƒçn√° & Vƒõcn√°</option>
            <option value="dramatic">Dramatick√° & Nal√©hav√°</option>
        </select>
    </div>

    <button class="btn-main" onclick="generuj()" id="btn-generate">
        <span id="btn-text">Generovat omluvu ‚ú®</span>
        <div class="loader" id="loader"></div>
    </button>

    <div id="vysledek">
        <label id="lbl-result">üí° Zde jsou va≈°e omluvy:</label>
        <div id="results-container"></div>
    </div>

    <hr style="border: 0; border-top: 1px solid var(--glass-border); width: 100%; margin: 1rem 0;">

    <button class="btn-vip" onclick="koupit()" id="btn-buy">
        <span>üëë Koupit Do≈æivotn√≠ Licenci (455 Kƒç)</span>
    </button>
</div>

<script>
    // --- 1. DATAB√ÅZE JAZYK≈Æ A P≈òEKLAD≈Æ ---
    const languages = [
        { code: "cs", name: "üá®üáø ƒåe≈°tina" },
        { code: "en_us", name: "üá∫üá∏ English (US)" },
        { code: "uk", name: "üá∫üá¶ –£–∫—Ä–∞—ó–Ω—Å—å–∫–∞" },
        { code: "de", name: "üá©üá™ Deutsch" },
        { code: "sk", name: "üá∏üá∞ Slovenƒçina" },
        { code: "pl", name: "üáµüá± Polski" },
        { code: "ru", name: "üá∑üá∫ –†—É—Å—Å–∫–∏–π" },
        { code: "fr", name: "üá´üá∑ Fran√ßais" },
        { code: "es", name: "üá™üá∏ Espa√±ol" },
        { code: "it", name: "üáÆüáπ Italiano" },
        { code: "pt", name: "üáµüáπ Portugu√™s" },
        { code: "zh", name: "üá®üá≥ ‰∏≠Êñá (Chinese)" },
        { code: "ja", name: "üáØüáµ Êó•Êú¨Ë™û (Japanese)" },
        { code: "ko", name: "üá∞üá∑ ÌïúÍµ≠Ïñ¥ (Korean)" },
        { code: "vi", name: "üáªüá≥ Ti·∫øng Vi·ªát" },
        { code: "tr", name: "üáπüá∑ T√ºrk√ße" },
        { code: "ar", name: "üá∏üá¶ ÿßŸÑÿπÿ±ÿ®Ÿäÿ© (Arabic)" },
        { code: "hi", name: "üáÆüá≥ ‡§π‡§ø‡§®‡•ç‡§¶‡•Ä (Hindi)" },
        { code: "th", name: "üáπüá≠ ‡πÑ‡∏ó‡∏¢ (Thai)" },
        { code: "id", name: "üáÆüá© Indonesia" },
        { code: "bn", name: "üáßüá© ‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ (Bengali)" },
        { code: "fil", name: "üáµüá≠ Filipino" },
        { code: "fa", name: "üáÆüá∑ ŸÅÿßÿ±ÿ≥€å (Persian)" }
    ];

    const translations = {
        cs: {
            subtitle: "Profesion√°ln√≠ gener√°tor omluv s AI.",
            lblRecipient: "üë§ Komu se omlouv√°te?",
            lblReason: "ü§î D≈Øvod (nebo napi≈°te vlastn√≠)",
            lblStyle: "üé≠ Styl omluvy",
            btnGenerate: "Generovat omluvu ‚ú®",
            btnBuy: "üëë Koupit Do≈æivotn√≠ Licenci (455 Kƒç)",
            placeholderReason: "Nap≈ô. zaspal jsem, nemoc...",
            recipients: ["≈†√©f", "Partner", "Uƒçitel", "Klient", "Kamar√°d", "Rodina"],
            styles: ["Profesion√°ln√≠", "Up≈ô√≠mn√°", "Kreativn√≠", "Struƒçn√°", "Dramatick√°"],
            suggestions: {
                boss: ["Zaspal jsem", "Nemoc", "Dopravn√≠ z√°cpa", "Rodinn√° nouze", "Technick√© probl√©my"],
                partner: ["Zapomnƒõl jsem na v√Ωroƒç√≠", "Jdu pozdƒõ na veƒçe≈ôi", "Nevynesl jsem ko≈°", "Byl jsem dlouho v pr√°ci"],
                teacher: ["Zapomnƒõl jsem √∫kol", "Nestihl jsem term√≠n", "Zaspal jsem", "Nerozumƒõl jsem zad√°n√≠"]
            }
        },
        en_us: {
            subtitle: "Professional AI Excuse Generator.",
            lblRecipient: "üë§ Who are you apologizing to?",
            lblReason: "ü§î Reason (or type your own)",
            lblStyle: "üé≠ Apology Style",
            btnGenerate: "Generate Excuse ‚ú®",
            btnBuy: "üëë Buy Lifetime License ($20)",
            placeholderReason: "E.g. Overslept, Sick...",
            recipients: ["Boss", "Partner", "Teacher", "Client", "Friend", "Family"],
            styles: ["Professional", "Sincere", "Creative", "Brief", "Dramatic"],
            suggestions: {
                boss: ["Overslept", "Sick leave", "Traffic jam", "Family emergency", "Car trouble"],
                partner: ["Forgot anniversary", "Late for date", "Stuck at work", "Too tired"],
                teacher: ["Forgot homework", "Missed deadline", "Overslept", "Computer crashed"]
            }
        },
        de: {
            subtitle: "Professioneller KI-Ausredengenerator.",
            lblRecipient: "üë§ Entschuldigung an wen?",
            lblReason: "ü§î Grund (oder eigenen eingeben)",
            lblStyle: "üé≠ Stil",
            btnGenerate: "Ausrede generieren ‚ú®",
            btnBuy: "üëë Lebenslange Lizenz kaufen (18‚Ç¨)",
            placeholderReason: "z.B. Verschlafen, Krank...",
            recipients: ["Chef", "Partner", "Lehrer", "Kunde", "Freund", "Familie"],
            styles: ["Professionell", "Aufrichtig", "Kreativ", "Kurz", "Dramatisch"],
            suggestions: {
                boss: ["Verschlafen", "Krankheit", "Stau", "Notfall", "Autopanne"],
                partner: ["Jahrestag vergessen", "Zu sp√§t", "Lange Arbeit", "M√ºde"],
                teacher: ["Hausaufgabe vergessen", "Frist verpasst", "Verschlafen"]
            }
        },
        // ... Zde by byly dal≈°√≠ jazyky. Pro uk√°zku pou≈æ√≠v√°m fallback na EN pro ostatn√≠, 
        // ale re√°lnƒõ by se doplnily v≈°echny. K√≥d je p≈ôipraven.
    };

    // Fallback funkce pro jazyky, kter√© nejsou plnƒõ vypsan√© naho≈ôe
    function getTranslation(langCode, key) {
        if (translations[langCode] && translations[langCode][key]) return translations[langCode][key];
        return translations['en_us'][key]; // V√Ωchoz√≠ angliƒçtina
    }

    // --- 2. INICIALIZACE A LOGIKA ---

    const langSelect = document.getElementById('language-select');
    const recipientSelect = document.getElementById('recipient');
    const styleSelect = document.getElementById('style');
    const reasonInput = document.getElementById('reason');
    const datalist = document.getElementById('reasons-list');

    // Naplnƒõn√≠ selectu jazyk≈Ø
    languages.forEach(lang => {
        const option = document.createElement('option');
        option.value = lang.code;
        option.innerText = lang.name;
        langSelect.appendChild(option);
    });

    // HLAVN√ç FUNKCE: ZMƒöNA JAZYKA
    function changeLanguage() {
        const lang = langSelect.value;
        
        // 1. Texty UI
        document.getElementById('txt-subtitle').innerText = getTranslation(lang, 'subtitle');
        document.getElementById('lbl-recipient').innerText = getTranslation(lang, 'lblRecipient');
        document.getElementById('lbl-reason').innerText = getTranslation(lang, 'lblReason');
        document.getElementById('lbl-style').innerText = getTranslation(lang, 'lblStyle');
        document.getElementById('btn-text').innerText = getTranslation(lang, 'btnGenerate');
        document.getElementById('btn-buy').querySelector('span').innerText = getTranslation(lang, 'btnBuy');
        reasonInput.placeholder = getTranslation(lang, 'placeholderReason');

        // 2. P≈ôeps√°n√≠ mo≈ænost√≠ v Selectech (Komu, Styl)
        const recipientList = getTranslation(lang, 'recipients');
        Array.from(recipientSelect.options).forEach((opt, i) => { if(recipientList[i]) opt.text = recipientList[i]; });

        const styleList = getTranslation(lang, 'styles');
        Array.from(styleSelect.options).forEach((opt, i) => { if(styleList[i]) opt.text = styleList[i]; });

        // 3. Refresh na≈°ept√°vaƒçe
        updateSuggestions();
    }

    // FUNKCE: NA≈†EPT√ÅVAƒå (Smart Suggestions)
    function updateSuggestions() {
        const lang = langSelect.value;
        const recipientVal = recipientSelect.value; // boss, partner...
        const t = translations[lang] || translations['en_us'];
        
        // Z√≠sk√°n√≠ pole d≈Øvod≈Ø podle p≈ô√≠jemce (nebo obecn√©)
        let suggestions = [];
        if (recipientVal === 'boss') suggestions = t.suggestions?.boss || t.suggestions?.boss;
        else if (recipientVal === 'partner') suggestions = t.suggestions?.partner || t.suggestions?.partner;
        else if (recipientVal === 'teacher') suggestions = t.suggestions?.teacher || t.suggestions?.teacher;
        else suggestions = ["Nest√≠h√°m", "Zapomnƒõl jsem", "Nemoc", "Osobn√≠ d≈Øvody"]; // Fallback

        // Vyƒçi≈°tƒõn√≠ a naplnƒõn√≠ datalistu
        datalist.innerHTML = '';
        if (suggestions) {
            suggestions.forEach(item => {
                const opt = document.createElement('option');
                opt.value = item;
                datalist.appendChild(opt);
            });
        }
    }

    // --- 3. API A PLATBA ---

    async function generuj() {
        const btnText = document.getElementById('btn-text');
        const loader = document.getElementById('loader');
        
        btnText.style.display = 'none';
        loader.style.display = 'block';

        const dataToSend = {
            jazyk: langSelect.options[langSelect.selectedIndex].text,
            adresat: recipientSelect.options[recipientSelect.selectedIndex].text,
            kategorie: reasonInput.value || "Obecn√Ω d≈Øvod",
            styl: styleSelect.options[styleSelect.selectedIndex].text,
            format: "email"
        };

        try {
            const response = await fetch('/api/generovat', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(dataToSend)
            });
            const data = await response.json();
            
            const container = document.getElementById('results-container');
            container.innerHTML = data.variants.map(v => `<div class="result-card">${v}</div>`).join('');
            document.getElementById('vysledek').style.display = 'block';
        } catch (e) {
            alert("Chyba: " + e.message);
        }

        btnText.style.display = 'block';
        loader.style.display = 'none';
    }

    function koupit() {
        // ZDE VLO≈Ω SV≈ÆJ NOV√ù ODKAZ ZE STRIPE PRO CENU 455 Kƒå
        window.location.href = 'https://buy.stripe.com/6oEg1...'; 
    }

    // Po naƒçten√≠ str√°nky zkontrolovat platbu a nastavit v√Ωchoz√≠ na≈°ept√°vaƒç
    window.onload = function() {
        updateSuggestions(); // Inicializace na≈°ept√°vaƒçe
        
        const urlParams = new URLSearchParams(window.location.search);
        if (urlParams.get('status') === 'success') {
            alert("Dƒõkujeme za n√°kup! V√≠tejte v klubu YES Genius üëë");
            document.getElementById('btn-buy').style.display = 'none';
        }
    };
</script>

</body>
</html>
