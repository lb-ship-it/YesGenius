<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>YES Genius | Professional Excuse Generator</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;500;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #8b5cf6; --accent: #10b981;
            --glass: rgba(255, 255, 255, 0.75); --glass-border: rgba(255, 255, 255, 0.6);
            --text: #1f2937; --text-light: #4b5563;
            --bg-gradient: linear-gradient(135deg, #a78bfa 0%, #34d399 100%);
            --option-bg: white; --option-text: black;
        }
        @media (prefers-color-scheme: dark) {
            :root {
                --glass: rgba(17, 24, 39, 0.75); --glass-border: rgba(255, 255, 255, 0.15);
                --text: #f3f4f6; --text-light: #d1d5db;
                --bg-gradient: linear-gradient(135deg, #4c1d95 0%, #065f46 100%);
                --option-bg: #1f2937; --option-text: white; /* Oprava ƒçitelnosti roletky v tmav√©m re≈æimu */
            }
        }
        * { box-sizing: border-box; transition: all 0.2s ease; -webkit-tap-highlight-color: transparent; }
        body { font-family: 'Outfit', sans-serif; background: var(--bg-gradient); background-attachment: fixed; margin: 0; min-height: 100vh; display: flex; justify-content: center; align-items: center; padding: 1rem; color: var(--text); }
        
        .glass-panel { background: var(--glass); backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px); border: 1px solid var(--glass-border); border-radius: 24px; padding: 2rem; width: 100%; max-width: 500px; box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25); display: flex; flex-direction: column; gap: 1.2rem; }

        /* NOV√Å HLAVIƒåKA (Logo + Texty vedle sebe) */
        .header-container { display: flex; align-items: center; gap: 1rem; margin-bottom: 0.5rem; }
        .logo { width: 70px; height: 70px; filter: drop-shadow(0 4px 6px rgba(0,0,0,0.1)); cursor: pointer; flex-shrink: 0; }
        .header-texts { display: flex; flex-direction: column; justify-content: center; }
        .app-title { margin: 0; font-weight: 800; font-size: 1.4rem; background: linear-gradient(90deg, var(--primary), var(--accent)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .subtitle { margin: 2px 0; opacity: 0.9; font-size: 0.85rem; font-weight: 500; }
        .second-sub { opacity: 0.7; font-size: 0.8rem; }

        label { font-weight: 500; font-size: 0.85rem; margin-left: 0.5rem; opacity: 0.9; display: block; margin-bottom: 0.3rem; }
        
        /* STYLOV√ÅN√ç INPUT≈Æ A ROLETEK */
        select, input, textarea { width: 100%; padding: 0.9rem 1rem; border-radius: 14px; border: 2px solid transparent; background: rgba(255, 255, 255, 0.4); font-size: 1rem; color: inherit; outline: none; font-family: inherit; appearance: none; background-image: url("data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%27http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%27%20width%3D%27292.4%27%20height%3D%27292.4%27%3E%3Cpath%20fill%3D%27%238b5cf6%27%20d%3D%27M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095c3.5-3.5%205.4-7.8%205.4-12.8%200-5-1.9-9.2-5.5-12.8z%27%2F%3E%3C%2Fsvg%3E"); background-repeat: no-repeat; background-position: right 1rem center; background-size: 0.8rem; padding-right: 2.5rem;}
        @media (prefers-color-scheme: dark) { select, input, textarea { background-color: rgba(0, 0, 0, 0.2); } }
        select:focus, input:focus { background-color: rgba(255, 255, 255, 0.6); border-color: var(--primary); box-shadow: 0 0 0 4px rgba(139, 92, 246, 0.15); }
        
        /* OPRAVA ƒåITELNOSTI MO≈ΩNOST√ç V ROLETCE (D≈Øle≈æit√©!) */
        select option { background-color: var(--option-bg); color: var(--option-text); }

        .btn-main { background: linear-gradient(90deg, var(--primary), #7c3aed); color: white; font-weight: 800; border: none; padding: 1rem; border-radius: 14px; cursor: pointer; font-size: 1.2rem; box-shadow: 0 10px 20px -5px rgba(124, 58, 237, 0.4); margin-top: 0.5rem; display: flex; justify-content: center; align-items: center; text-transform: uppercase; letter-spacing: 0.5px;}
        .btn-main:active { transform: scale(0.97); }
        .btn-vip { background: linear-gradient(90deg, var(--accent), #059669); color: white; font-weight: 700; border: none; padding: 0.9rem; border-radius: 14px; cursor: pointer; font-size: 1rem; display: flex; justify-content: center; align-items: center; gap: 0.5rem; box-shadow: 0 4px 10px rgba(16, 185, 129, 0.3); }

        #vysledek { margin-top: 1rem; display: none; }
        .result-card { background: rgba(255, 255, 255, 0.5); padding: 1rem; border-radius: 12px; margin-bottom: 0.8rem; border-left: 4px solid var(--primary); font-size: 0.95rem; line-height: 1.5; font-weight: 500; }
        @media (prefers-color-scheme: dark) { .result-card { background: rgba(0, 0, 0, 0.3); } }
        .loader { border: 3px solid rgba(255,255,255,0.3); border-radius: 50%; border-top: 3px solid white; width: 22px; height: 22px; animation: spin 0.8s linear infinite; display: none; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body>

<div class="glass-panel">
    <div class="header-container">
        <img src="logo.png" alt="YES Genius Logo" class="logo" onclick="location.reload()">
        <div class="header-texts">
            <h2 class="app-title">YES Genius</h2>
            <p class="subtitle main-sub" id="txt-subtitle">Profesion√°ln√≠ gener√°tor omluv s umƒõlou inteligenc√≠.</p>
            <p class="subtitle second-sub" id="txt-subtitle2">Tv≈Øj rychl√Ω r√°dce v kapse!</p>
        </div>
    </div>

    <div style="margin-top: -0.5rem;">
        <select id="language-select" onchange="changeLanguage()" style="padding-top: 0.7rem; padding-bottom: 0.7rem; font-size: 0.9rem;">
            </select>
    </div>

    <div>
        <label id="lbl-recipient" for="recipient">üë§ Komu?</label>
        <select id="recipient" onchange="updateSuggestions()">
            <option value="boss">≈†√©f / Nad≈ô√≠zen√Ω</option>
            <option value="partner">Partner / Partnerka</option>
            <option value="teacher">Uƒçitel / Profesor</option>
            <option value="client">Klient / Z√°kazn√≠k</option>
            <option value="friend">Kamar√°d / Zn√°m√Ω</option>
            <option value="family">Rodiƒçe / Rodina</option>
            <option value="motherinlaw">Tch√Ωnƒõ</option> <option value="fatherinlaw">Tch√°n</option>   </select>
    </div>

    <div>
        <label id="lbl-reason" for="reason">ü§î D≈Øvod (nebo vlastn√≠)</label>
        <input list="reasons-list" id="reason" placeholder="...">
        <datalist id="reasons-list"></datalist>
    </div>

    <div>
        <label id="lbl-style" for="style">üé≠ Styl</label>
        <select id="style">
            <option value="professional">Profesion√°ln√≠ & Form√°ln√≠</option>
            <option value="sincere">Up≈ô√≠mn√° & Kaj√≠cn√°</option>
            <option value="creative">Kreativn√≠ & Vtipn√°</option>
            <option value="brief">Struƒçn√° & Vƒõcn√°</option>
            <option value="dramatic">Dramatick√° (Nal√©hav√°)</option>
        </select>
    </div>

    <button class="btn-main" onclick="generuj()" id="btn-generate">
        <span id="btn-text">YES Generovat</span>
        <div class="loader" id="loader"></div>
    </button>

    <div id="vysledek">
        <div id="results-container"></div>
    </div>

    <hr style="border: 0; border-top: 1px solid var(--glass-border); width: 100%; margin: 0.5rem 0; opacity: 0.5;">

    <button class="btn-vip" onclick="koupit()" id="btn-buy">
        <span>üëë Koupit Do≈æivotn√≠ Licenci (455 Kƒç)</span>
    </button>
</div>

<script>
    // --- KOMPLETN√ç SEZNAM 22 JAZYK≈Æ ---
    const languages = [
        { code: "cs", name: "üá®üáø ƒåe≈°tina" }, { code: "en_us", name: "üá∫üá∏ English (US)" }, { code: "de", name: "üá©üá™ Deutsch" },
        { code: "sk", name: "üá∏üá∞ Slovenƒçina" }, { code: "pl", name: "üáµüá± Polski" }, { code: "uk", name: "üá∫üá¶ –£–∫—Ä–∞—ó–Ω—Å—å–∫–∞" },
        { code: "ru", name: "üá∑üá∫ –†—É—Å—Å–∫–∏–π" }, { code: "fr", name: "üá´üá∑ Fran√ßais" }, { code: "es", name: "üá™üá∏ Espa√±ol" },
        { code: "it", name: "üáÆüáπ Italiano" }, { code: "pt", name: "üáµüáπ Portugu√™s" }, { code: "zh", name: "üá®üá≥ ‰∏≠Êñá (Chinese)" },
        { code: "ja", name: "üáØüáµ Êó•Êú¨Ë™û (Japanese)" }, { code: "ko", name: "üá∞üá∑ ÌïúÍµ≠Ïñ¥ (Korean)" }, { code: "vi", name: "üáªüá≥ Ti·∫øng Vi·ªát" },
        { code: "tr", name: "üáπüá∑ T√ºrk√ße" }, { code: "ar", name: "üá∏üá¶ ÿßŸÑÿπÿ±ÿ®Ÿäÿ© (Arabic)" }, { code: "hi", name: "üáÆüá≥ ‡§π‡§ø‡§®‡•ç‡§¶‡•Ä (Hindi)" },
        { code: "th", name: "üáπüá≠ ‡πÑ‡∏ó‡∏¢ (Thai)" }, { code: "id", name: "üáÆüá© Indonesia" }, { code: "bn", name: "üáßüá© ‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ (Bengali)" },
        { code: "fil", name: "üáµüá≠ Filipino" }, { code: "fa", name: "üáÆüá∑ ŸÅÿßÿ±ÿ≥€å (Persian)" }
    ];

    // --- P≈òEKLADY UI (Zkr√°ceno pro p≈ôehlednost, dopl≈à si dal≈°√≠ dle pot≈ôeby) ---
    const t = {
        cs: {
            sub1: "Profesion√°ln√≠ gener√°tor omluv s AI.", sub2: "Tv≈Øj rychl√Ω r√°dce v kapse!",
            lblRec: "üë§ Komu?", lblRea: "ü§î D≈Øvod (nebo vlastn√≠)", lblSty: "üé≠ Styl",
            btnGen: "Generovat", btnBuy: "üëë Koupit Do≈æivotn√≠ Licenci (455 Kƒç)",
            phRea: "Nap≈ô. zaspal jsem...",
            rec: ["≈†√©f", "Partner/ka", "Uƒçitel", "Klient", "Kamar√°d", "Rodina", "Tch√Ωnƒõ", "Tch√°n"],
            sty: ["Profesion√°ln√≠", "Up≈ô√≠mn√°", "Kreativn√≠", "Struƒçn√°", "Dramatick√°"],
            sug: {
                boss: ["Zaspal jsem", "Nemoc", "Dopravn√≠ kolaps", "Rodinn√° nouze"],
                partner: ["Zapomnƒõl/a jsem", "Zdr≈æen√≠ v pr√°ci", "Jsem unaven√Ω/√°"],
                motherinlaw: ["Zapomnƒõli jsme na n√°v≈°tƒõvu", "Nest√≠h√°me obƒõd", "Mus√≠me neƒçekanƒõ pryƒç"], // Nov√©
                fatherinlaw: ["Nest√≠h√°m pomoct", "Zdr≈æen√≠ v pr√°ci", "Auto st√°vkuje"] // Nov√©
            }
        },
        en_us: {
            sub1: "Professional AI Excuse Generator.", sub2: "Your quick pocket advisor!",
            lblRec: "üë§ To Whom?", lblRea: "ü§î Reason (or custom)", lblSty: "üé≠ Style",
            btnGen: "Generate", btnBuy: "üëë Buy Lifetime License ($20)",
            phRea: "E.g. Overslept...",
            rec: ["Boss", "Partner", "Teacher", "Client", "Friend", "Family", "Mother-in-law", "Father-in-law"],
            sty: ["Professional", "Sincere", "Creative", "Brief", "Dramatic"],
            sug: { boss: ["Overslept", "Sick leave", "Traffic"], partner: ["Forgot", "Stuck at work"], motherinlaw: ["Forgot visit", "Running late"], fatherinlaw: ["Can't help today", "Work issue"] }
        },
        de: {
            sub1: "Professioneller KI-Ausredengenerator.", sub2: "Ihr schneller Taschenberater!",
            lblRec: "üë§ An wen?", lblRea: "ü§î Grund (oder eigener)", lblSty: "üé≠ Stil",
            btnGen: "Generieren", btnBuy: "üëë Lebenslange Lizenz (18‚Ç¨)",
            phRea: "z.B. Verschlafen...",
            rec: ["Chef", "Partner", "Lehrer", "Kunde", "Freund", "Familie", "Schwiegermutter", "Schwiegervater"],
            sty: ["Professionell", "Aufrichtig", "Kreativ", "Kurz", "Dramatisch"]
        }
        // ... dal≈°√≠ jazyky pou≈æ√≠vaj√≠ anglick√Ω fallback
    };

    function getT(lang, key) { return (t[lang] && t[lang][key]) ? t[lang][key] : t['en_us'][key]; }

    const LS = document.getElementById('language-select'); const RS = document.getElementById('recipient');
    const SS = document.getElementById('style'); const RI = document.getElementById('reason'); const DL = document.getElementById('reasons-list');

    languages.forEach(l => { const o = document.createElement('option'); o.value = l.code; o.innerText = l.name; LS.appendChild(o); });

    function changeLanguage() {
        const l = LS.value;
        document.getElementById('txt-subtitle').innerText = getT(l, 'sub1');
        document.getElementById('txt-subtitle2').innerText = getT(l, 'sub2');
        document.getElementById('lbl-recipient').innerText = getT(l, 'lblRec');
        document.getElementById('lbl-reason').innerText = getT(l, 'lblRea');
        document.getElementById('lbl-style').innerText = getT(l, 'lblSty');
        // Tlaƒç√≠tko YES + p≈ôelo≈æen√© slovo Generovat
        document.getElementById('btn-text').innerText = "YES " + getT(l, 'btnGen');
        document.getElementById('btn-buy').querySelector('span').innerText = getT(l, 'btnBuy');
        RI.placeholder = getT(l, 'phRea');
        const rl = getT(l, 'rec'); Array.from(RS.options).forEach((o, i) => { if(rl[i]) o.text = rl[i]; });
        const sl = getT(l, 'sty'); Array.from(SS.options).forEach((o, i) => { if(sl[i]) o.text = sl[i]; });
        updateSuggestions();
    }

    function updateSuggestions() {
        const l = LS.value; const rv = RS.value; const tr = t[l] || t['en_us'];
        const sug = tr.sug?.[rv] || ["Nest√≠h√°m", "Nemoc", "Osobn√≠ d≈Øvody"];
        DL.innerHTML = ''; sug.forEach(i => { const o = document.createElement('option'); o.value = i; DL.appendChild(o); });
    }

    // --- LOGIKA GENERACE A PLATBY (3. KLIK) ---
    let clickCount = 0; // POƒå√çTADLO KLIKNUT√ç

    async function generuj() {
        clickCount++; // Zv√Ω≈°it poƒç√≠tadlo
        console.log("Kliknut√≠ ƒç√≠slo:", clickCount);

        // POKUD JE TO 3. KLIKNUT√ç -> VYVOLAT PLATBU A ZASTAVIT GENERACI
        if (clickCount >= 3) {
            koupit();
            return; // Nepokraƒçovat v generov√°n√≠
        }

        // Jinak norm√°ln√≠ generov√°n√≠
        const bt = document.getElementById('btn-text'); const ld = document.getElementById('loader');
        bt.style.display = 'none'; ld.style.display = 'block'; document.getElementById('vysledek').style.display = 'none';

        try {
            const res = await fetch('/api/generovat', {
                method: 'POST', headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    jazyk: LS.options[LS.selectedIndex].text, adresat: RS.options[RS.selectedIndex].text,
                    kategorie: RI.value || "Obecn√Ω d≈Øvod", styl: SS.options[SS.selectedIndex].text, format: "email"
                })
            });
            const data = await res.json();
            document.getElementById('results-container').innerHTML = data.variants.map(v => `<div class="result-card">${v}</div>`).join('');
            document.getElementById('vysledek').style.display = 'block';
        } catch (e) { alert("Chyba AI. Zkuste to pros√≠m znovu."); }
        bt.style.display = 'block'; ld.style.display = 'none';
    }

    function koupit() {
        // !!! ZDE VLO≈Ω SV≈ÆJ ODKAZ ZE STRIPE PRO CENU 455 Kƒå !!!
        window.location.href = 'https://buy.stripe.com/cNieVegBL0GwaFM0jga7C02'; 
    }

    window.onload = function() {
        changeLanguage(); // Inicializace jazyka a text≈Ø
        if (new URLSearchParams(window.location.search).get('status') === 'success') {
            alert("Dƒõkujeme za n√°kup! Jste nav≈ædy YES Genius üëë");
            document.getElementById('btn-buy').style.display = 'none';
            clickCount = -9999; // Deaktivace platebn√≠ br√°ny pro plat√≠c√≠
        }
    };
</script>
</body>
</html>

